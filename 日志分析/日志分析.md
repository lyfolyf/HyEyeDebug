### 1、日志文件说明



### 2、实例分析

为了方便截图，以下截图日志，都经过了筛选

所有截图中，绿色标记部分表示正确的行为，红色标记部分是错误的行为

#### 案例1

![1](Image\案例1-1.png)

![2](Image\案例1-2.png)



**来源**

Dory 项目

**流程说明**

飞拍，拍 5 次，5 次拍照指令一次性发送给 HyEye。

**现象**

取像超时

**原因分析**

从上往下，先收到了指令：`T6,1,A;T6,2,A;T6,3,A;T6,4,A;T6,5,A`，之后 5 次取图，帧号 77421-77425，这里是正确的。

之后取到图像 **77426** 帧，然后再收到指令：`T7,5,A;T7,4,A;T7,3,A;T7,2,A;T7,1,A`，这个顺序就错了，必须是先收到指令，再收到图像。如果先收到图像，则这张图像必定被丢弃，可以看到，有丢弃图像的日志。

5 张图，丢弃了一张图，之后收到的 4 张图被分别对应到 1-4 次取像，第 5 次取像没有图，必然就报超时了。

**检查**

查看上位机日志，检查指令发送时间跟 HyEye 日志里的接收时间是否能对上，如果能对上，则说明上位机指令发送和触发拍照的顺序错乱了。

如果上位机日志中指令发送时间和 HyEye 日志中指令接收时间对不上（相差比较大，一般 1-2 ms 的误差认为是合理的），则可能是 TCP 通讯卡顿了，请联系研发。



#### 案例2

![案例2-1](Image\案例2-1.png)

**来源**

RCAM 项目

**流程说明**

一个料拍两次，两次的曝光不同。一个料两次拍完后拍下一个料，所以每次拍照都要设置曝光。

相机为硬触发，曝光由 HyEye 设置。上位机发送指令后，延时 500 ms 发送脉冲拍照。

**现象**

图像曝光不对

**现象分析**

[10000060] 指令收到后 12 ms 设置曝光值，之后取像正常。

[10000061] 指令收到后 502 ms 设置曝光值，超过了上位机的延时时间，所以先拍照，再设置曝光了，导致图像曝光值不对。

**原因分析**

由于是同一个相机，HyEye 必然是在收到前一次拍照的图像之后，才会去设置下一次拍照的曝光。

日志中，收到 [10000060] 指令的图像的时间是 50.195，设置下一次曝光的时间是 50.208，间隔 13 ms，这是正常的。

收到 [10000060] 指令的时间是 48.536，距离收到图像的时间 50.195，间隔是 1.659，得到结论是 [10000060] 出图慢了。

**解决方案**

AR 指令改为 A 指令 + R 指令，上位机在收到 A 指令回复后开始走位。

